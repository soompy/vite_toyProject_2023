<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Spartan:wght@700&display=swap" rel="stylesheet">
    <title>춘식러버 페이지 - 춘식이 소개</title>
</head>

<body>
    <load="/header.html" />

    <div class="choonsik-lover-wrapper">

        <section class="area-common" style="overflow: auto;">
            <input type="radio" class="radio-test">
        
            <div class="scroll-container">
                <div class="scroll-area">
                    <div class="about-box">
                        <span class="profile-photo"><img src="https://blog.kakaocdn.net/dn/dizXY5/btrkIPfapS1/jt8zro5LbaSUub4dDmSW6k/img.jpg" alt="춘식이증명사진"></span>
                        <div class="about-choonsik">
                            <p><span>이름 : </span> <strong>춘식이</strong></p>
                            <p><span>생년월일 : </span> <strong>2020년</strong></p>
                            <p><span>성별 :</span> <strong>??</strong></p>
                            <p><span>특징 : </span> <strong>라이언의 반려묘</strong></p>
                        </div>
                    </div>                    
                </div>

                <div class="scroll-area">
                    <div class="profile-choonsik">
                        <div class="profile-bg">
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                            <span class="bg-circle"></span>
                        </div>
                        <div class="profile-box">
                            <div class="profile-item">
                                <div class="spinner">
                                    <span class="triangle"></span>
                                    <div class="talk">
                                        <p>초록 삼각형 잡을거양 <span class="talk-tail"></span></p>
                                        <img class="following"
                                            src="https://item.kakaocdn.net/do/b5d3d6a7b67fbf5afdaffb79fffbf8b115b3f4e3c2033bfd702a321ec6eda72c"
                                            alt="따라다니는춘식이">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="scroll-area">
                    <section class="choonsik-chart">
                        <!-- <h3>춘식이의 매력을 알아볼까용</h3> -->
                        <span class="lovely-text">매력도 click!!</span>
                        <canvas id="lovelyChoonsik" width="400" height="400"></canvas>
                    </section>
                </div>

                <div class="scroll-area">
                    <h3 class="choonsik-music">춘식이's <br> pick music</h3>                    

                    <!-- 원형 프로그레스바 -->
                    <div class="music-progress-wrap">                        
                        <svg class="music-progress" width="400" height="400" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">                                                    
                            <!-- Music Player Circle -->
                            <circle class="outside-circle" cx="200" cy="200" r="180" viewBox="0 0 400 400" fill="#f0f0f0" stroke-width="6" />

                            <defs>
                                <linearGradient id="gradientStroke" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stop-color="red" />
                                    <stop offset="50%" stop-color="hotpink" />
                                    <stop offset="100%" stop-color="purple" />
                                </linearGradient>

                                <pattern id="image-cover" x="0" y="0" patternUnits="userSpaceOnUse" width="400" height="400">
                                  <image x="0" y="0" width="400" height="400" xlink:href="https://image.bugsm.co.kr/album/images/500/40686/4068625.jpg" />
                                </pattern>
                            </defs>

                            <!-- Progress Circle -->
                            <circle class="inside-circle" id="progressCircle" cx="200" cy="200" r="160" viewBox="0 0 400 400" fill="url(#image-cover)" stroke-width="6" stroke="url(#gradientStroke)" stroke-dashoffset="0" stroke-dasharray="0, 1010" />

                            <!-- Current Time Text -->
                            <text class="music-timer" x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">
                                0:00
                            </text>                
                        </svg>

                        <!-- 재생/정지 버튼 -->
                        <div class="play-btn" id="playPauseBtn" onclick="togglePlayPause()">
                            <svg class="play-icon" width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                <circle class="play-circle" cx="20" cy="20" r="20" fill="#4CAF50" />
                                <polygon x="20" y="20" points="13,11 13,31 33,21" fill="#fff" />
                            </svg>

                            <svg class="pause-icon" width="40" height="40" viewBox="0 0 40 40">
                                <rect class="pause-bar" x="13" y="8" width="4" height="24" fill="#4CAF50" />
                                <rect class="pause-bar" x="23" y="8" width="4" height="24" fill="#4CAF50" />
                            </svg>
                        </div>                                        
                    </div>
                </div>
            </div>
        </section>
    </div>

    <load="/footer.html" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="/main.js"></script>

    <script>
        const ctx = document.getElementById('lovelyChoonsik');

        ctx.width = 600;
        ctx.height = 300;

        new Chart(ctx, {
            type: 'bar',
            tooltipFillColor: "rgba(51, 51, 51, 0.55)",
            data: {
                labels: ['귀여움', '사랑스러움', '깜찍함', '멋짐'],
                datasets: [{
                    label: 'lovely choonsik',
                    data: [25, 19, 13, 15],
                    backgroundColor: [
                        "#F6F7C1",
                        "#BEF0CB",
                        "#D1FFF3",
                        "#C1AEFC"
                    ],
                }],
            },
            options: {
                scales: {
                    x: {
                        grid: {
                            display: false
                        },  
                        ticks: {
                            font: {
                              size: 20
                            }
                        },
                    },
                    y: {
                        grid: {
                            display: false
                        },
                        beginAtZero: true,
                        ticks: {
                            font: {
                              size: 20
                            }
                        },
                    },                    
                },
                responsive: false,
                indexAxis: 'y',
                plugins: {
                    datalabels: {
                        formatter: (value) => {
                            return value + '%';
                        },
                    },
                    legend: {
                        labels: {
                            font: function() {
                                const size = Math.round(20)

                                return {
                                    size: size,
                                    family: 'TypoCrayonB',
                                }                                
                            },
                        }
                    },
                },
            },
        });
    

        const progressCircle = document.getElementById('progressCircle');
        const playPauseBtn = document.getElementById('playPauseBtn');
        
        const playBtn = document.querySelector('.play-icon');
        const pauseBtn = document.querySelector('.pause-icon');

        const insideCircle = document.querySelector(".inside-circle");
        const musicTimer = document.querySelector(".music-timer");
        const insideBtnR = insideCircle.getAttribute('r');

        const duration = 180;
        let isPlaying = false;
        let currentTime = 0;

        pauseBtn.style.display = "none";
        musicTimer.style.display = "none";
        
        function togglePlayPause() {
            isPlaying = !isPlaying;
            if (isPlaying) {
                playBtn.style.display = "none";
                pauseBtn.style.display = "block";
                insideCircle.setAttribute('filter', 'contrast(0.5)');                 
                musicTimer.style.display = "block";
                playPauseBtn.setAttribute('fill', 'red');
                startMusic();
            } else {
                playBtn.style.display = "block";          
                pauseBtn.style.display = "none";      
                insideCircle.setAttribute('filter', 'none');                 
                musicTimer.style.display = "none";
                playPauseBtn.setAttribute('fill', '#333');
                pauseMusic();
            }
        }

        function updateProgress() {
            const progress = currentTime / duration;      
            const dashOffset = progress * (2 * insideBtnR * 3.14); // 1010 = circumference of the progress circle            
            progressCircle.setAttribute('stroke-dasharray', dashOffset + ', 1010');
            document.querySelector('text').textContent = formatTime(currentTime);
        }

        function startMusic() {
            musicInterval = setInterval(() => {
                if (currentTime < duration) {
                    currentTime++;
                    updateProgress();
                } else {
                    pauseMusic();
                }
            }, 1000);
        }

        function pauseMusic() {
            clearInterval(musicInterval);
        }

        function formatTime(time) {
            const minutes = Math.floor(time / 60);
            const seconds = time % 60;
            return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        updateProgress(); // Set initial progress
    </script>

    <script type="module" src="/main.js"></script>
</body>

</html>