<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Spartan:wght@700&display=swap" rel="stylesheet">
    <title>춘식러버 페이지 - 춘식이 소개</title>
</head>

<body>
    <load="/header.html" />

    <div class="wrapper">
        <section class="area-common">
            <!-- 디제이 춘식이의 플레이리스트 살짝공개 -->
            <div class="music-progress-wrap">                        
                <svg class="music-progress" width="400" height="400" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">                                                    
                    <style>
                        #image-cover {
                            transform: rotate(90deg);
                        }
                    </style>
                    <!-- Music Player Circle -->
                    <circle class="outside-circle" cx="200" cy="200" r="180" viewBox="0 0 400 400" fill="#f0f0f0" stroke-width="6" />

                    <defs>
                        <linearGradient id="gradientStroke" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" stop-color="red" />
                            <stop offset="50%" stop-color="hotpink" />
                            <stop offset="100%" stop-color="purple" />
                        </linearGradient>

                        <pattern id="image-cover" x="0" y="0" patternUnits="userSpaceOnUse" width="400" height="400">
                        <image x="0" y="0" width="400" height="400" xlink:href="https://image.bugsm.co.kr/album/images/500/40686/4068625.jpg" />
                        </pattern>
                    </defs>

                    <!-- Progress Circle -->
                    <circle class="inside-circle" id="progressCircle" cx="200" cy="200" r="160" d="M 200 0" viewBox="0 0 400 400" fill="url(#image-cover)" stroke-width="6" stroke="url(#gradientStroke)" stroke-dashoffset="0" stroke-dasharray="0, 1010" />

                    <!-- Current Time Text -->
                    <text class="music-timer" x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">
                        0:00
                    </text>                
                </svg>

                <!-- 재생/정지 버튼 -->
                <div class="play-btn" id="playPauseBtn" onclick="togglePlayPause()">
                    <svg class="play-icon" width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                        <circle class="play-circle" cx="20" cy="20" r="20" fill="#4CAF50" />
                        <polygon x="20" y="20" points="13,11 13,31 33,21" fill="#fff" />
                    </svg>

                    <svg class="pause-icon" width="40" height="40" viewBox="0 0 40 40">
                        <rect class="pause-bar" x="13" y="8" width="4" height="24" fill="#4CAF50" />
                        <rect class="pause-bar" x="23" y="8" width="4" height="24" fill="#4CAF50" />
                    </svg>
                </div>                                        
            </div>            
        </section>

        <section class="area-common">
            <!-- 라이언과 간식타임 -->
            <div class="lunch-time">
                
            </div>
        </section>

        <section class="area-common">
            <!-- 라이언과 댄스시간 -->
            <div class="dance-time"></div>
        </section>        
    </div>

    <load="/footer.html" />

    <script type="module" src="/main.js"></script>

    <script>
        const progressCircle = document.getElementById('progressCircle');
        const playPauseBtn = document.getElementById('playPauseBtn');
        
        const playBtn = document.querySelector('.play-icon');
        const pauseBtn = document.querySelector('.pause-icon');

        const insideCircle = document.querySelector(".inside-circle");
        const musicTimer = document.querySelector(".music-timer");
        const insideBtnR = insideCircle.getAttribute('r');

        const duration = 180;
        let isPlaying = false;
        let currentTime = 0;

        pauseBtn.style.display = "none";
        musicTimer.style.display = "none";
        
        function togglePlayPause() {
            isPlaying = !isPlaying;
            if (isPlaying) {
                playBtn.style.display = "none";
                pauseBtn.style.display = "block";
                insideCircle.setAttribute('filter', 'contrast(0.5)');                 
                musicTimer.style.display = "block";
                playPauseBtn.setAttribute('fill', 'red');
                startMusic();
            } else {
                playBtn.style.display = "block";          
                pauseBtn.style.display = "none";      
                insideCircle.setAttribute('filter', 'none');                 
                musicTimer.style.display = "none";
                playPauseBtn.setAttribute('fill', '#333');
                pauseMusic();
            }
        }

        function updateProgress() {
            const progress = currentTime / duration;      
            const dashOffset = progress * (2 * insideBtnR * 3.14); // 1010 = circumference of the progress circle            
            progressCircle.setAttribute('stroke-dasharray', dashOffset + ', 1010');
            document.querySelector('text').textContent = formatTime(currentTime);
        }

        function startMusic() {
            musicInterval = setInterval(() => {
                if (currentTime < duration) {
                    currentTime++;
                    updateProgress();
                } else {
                    pauseMusic();
                }
            }, 1000);
        }

        function pauseMusic() {
            clearInterval(musicInterval);
        }

        function formatTime(time) {
            const minutes = Math.floor(time / 60);
            const seconds = time % 60;
            return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        updateProgress(); // Set initial progress
    </script>

    <script type="module" src="/main.js"></script>
</body>

</html>