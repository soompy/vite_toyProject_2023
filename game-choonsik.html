<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Spartan:wght@700&display=swap" rel="stylesheet">
    <title>춘식러버 페이지 - 춘식이 게임</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>

    <style>        
        .the-svg {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: var(--clr-secondary);
        }

        svg {
            background: var(--clr-reversal);
        }
    </style>
</head>

<body>
    <load="/header.html" />

    <div class="choonsik-lover-wrapper">
        <div class="inner">
            <h2 class="light-text">
                <span>There's</span>
                <span class="light">light</span>
                <span> even in</span>
                <span>the darkest</span>
                <span>places</span>
            </h2>
        </div>
    </div>

    <!-- 스크롤 배경 스케일 & 스티키 텍스트 영역 -->
    <div id="stickyStart"></div>

    <section class="scrolling-contents">
        <div class="scalebg">
            <img src="https://cdn.pixabay.com/photo/2021/01/14/19/30/water-5917708__480.jpg" alt="">
        </div>
        <div class="sticky-text">
            <div class="inner">
                <p>
                    숨은 춘식이 찾기!!
                    <i class="icon-point-down"></i>
                </p>
            </div>
        </div>
    </section>

    <div id="stickyEnd"></div>

    <section class="game-board">
        <!-- <div id="face-wrap">
            <svg version="1.1" id="face" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"
                data-llp-composed="true">
                <g id="eyes">
                    <circle data-llp-id="llpface-0" class="st0" cx="50" cy="49.7" r="48" data-llp-duration="1000"
                        data-llp-ease="easeExpoOut" />
                    <path data-llp-id="llpface-1" d="M19.8,32.9c0,0,1.9,4.4,6.1,4.4c4.2,0,6.1-4.4,6.1-4.4s1.7,4.4,6.1,4.4c4.4,0,6.1-4.4,6.1-4.4s2,4.4,6.1,4.4
              s6.1-4.4,6.1-4.4s1.8,4.4,6.1,4.4c4.3,0,6.1-4.4,6.1-4.4s2.5,4.4,6.1,4.4c3.6,0,6.1-4.4,6.1-4.4"
                        data-llp-duration="1000" data-llp-delay="1000" />
                </g>
                <path data-llp-id="llpface-2" d="M40.2,57.2c0,0-1.6-6.2-7.7-6.2c-5.2,0-7.7,6.2-7.7,6.2"
                    data-llp-duration="800" data-llp-ease="easeExpoInOut" data-llp-delay="1200" />
                <path data-llp-id="llpface-3" d="M75.3,56.8c0,0-2.2-5.8-7.2-5.8c-5,0-7.2,5.8-7.2,5.8"
                    data-llp-duration="800" data-llp-delay="1200" />

                <path data-llp-id="llpface-4" d="M32.9,67.1c0,0,3.9,13.5,16.9,13.5c13.8,0,16.9-13.5,16.9-13.5"
                    data-llp-duration="800" data-llp-delay="1200" />
            </svg>
        </div> -->

        <svg class="the-svg">
            <defs>
                <pattern id="pattern-bg" x="0" y="0" width="0.1" height="0.1">
                    <circle cx="80" cy="80" r="160" d="M 80 0" viewBox="0 0 80 80" fill="url(#choonsik-face)" />
                    <path
                        d="M138.61,133a29.89,29.89,0,1,1,21.14-8.75A29.72,29.72,0,0,1,138.61,133Zm0-55.38a25.49,25.49,0,1,0,18,7.46A25.32,25.32,0,0,0,138.61,77.63Z"
                        transform="translate(-107 -64)" />
                    <g>
                        <circle cx="19.31" cy="41.98" r="4.69" />
                        <circle class="left-eye" cx="43.8" cy="41.98" r="4.69" />
                    </g>
                    <path
                        d="M138.61,124.88h-.05a21.76,21.76,0,0,1-16.19-7.24l2.47-2.21a18.44,18.44,0,0,0,13.72,6.14h.05a18.44,18.44,0,0,0,13.72-6.14l2.46,2.21A21.73,21.73,0,0,1,138.61,124.88Z"
                        transform="translate(-107 -64)" />
                    <path
                        d="M154.28,72.27a17.56,17.56,0,0,0-3.94.44c-1.76-5-8.37-8.71-16.25-8.71-9.15,0-16.58,5-16.72,11.2C111.23,77.38,107,82,107,87.23c0,7.4,8.32,13.4,18.59,13.4,6.84,0,12.82-2.66,16-6.63a16.61,16.61,0,0,0,12.65,5.53C163,99.53,170,93.43,170,85.9S163,72.27,154.28,72.27Z"
                        transform="translate(-107 -64)" />                                                        
                </pattern>                

                <!-- 춘식이 얼굴 -->
                <circle id="choonsik-face" x="0" y="0" cx="50" cy="50" r="50" patternUnits="userSpaceOnUse" width="100" height="100">
                    <image x="0" y="0" width="100" height="100" xlink:href="https://m.switchs.co.kr/web/product/big/202303/a429abd3b01ea983738ab857c58bea83.png" />
                </circle>

                <!-- <mask id="mask-glass">
                    <circle cx="80.51" cy="80.51" r="60" fill="#fff" />                    
                </mask> -->

                <style>                                        
                    @keyframes eye-ani {
                        to {
                            transform: scaleY(0.2);
                        }
                    }

                    .left-eye {
                        transform-origin: 44px 42px;
                        animation: eye-ani 1s alternate infinite;
                    }

                    .bg {
                        fill: url(#pattern-bg);
                    }                    
                </style>

                <script>
                    <!-- game-board -->
                    window.addEventListener('DOMContentLoaded', () => {
                        const magnifierElem = document.querySelector('.magnifier');
                        const maskElem = document.querySelector('#mask-glass circle');
                        const gameBoard = document.querySelector('.game-board');
                        const magnifierElemPath = gameBoard.getBoundingClientRect();     
                        const magnifierSize = magnifierElem.getBoundingClientRect();                      


                        gameBoard.addEventListener('mousemove', (e) => {
                            const mouseX = e.clientX - magnifierElemPath.left;
                            const mouseY = e.clientY - magnifierElemPath.top;                            

                            magnifierElem.style.transform = `translate(${mouseX - (magnifierSize.width / 2)}px, ${mouseY - (magnifierSize.height / 2)}px)`;
                            maskElem.style.transform = `translate(${mouseX - (magnifierSize.width / 2)}px, ${mouseY - (magnifierSize.height / 2)}px)`;
                        });
                    });
                </script>
            </defs>

            <path class="magnifier"
                d="M150.81 41.26a80.5 80.5 0 1 0-41.94 114.6l36.28 64.95a12 12 0 1 0 20.95-11.7l-36.29-64.95a80.51 80.51 0 0 0 21-102.9zm-41 91.63a60 60 0 1 1 23.12-81.64 60 60 0 0 1-23.12 81.64z"
                fill="#fff" />
            <g mask="url(#mask-glass)">
                <rect class="bg" x="0" y="0" width="100%" height="100%"></rect>
            </g>
        </svg>
    </section>

    <load="/footer.html" />

    <script type="module" src="/main.js"></script>
    <script src="./node_modules/animejs/lib/anime.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>

    <script>
        // detector
        window.ScrollDetector = window.ScrollDetector || window.scrollDetector || function () {
            this.items = [];
            this.add = function (_el, action, options) {
                var el;
                if (window.jQuery && _el instanceof window.jQuery) {
                    el = _el[0]
                } else {
                    el = _el
                }
                this.items.push(new Item(el, action, options));
                detectScroll();
            };

            function getOffset(element) {
                if (!element.getClientRects().length) {
                    return { top: 0, left: 0 };
                }
                var rect = element.getBoundingClientRect();
                var win = element.ownerDocument.defaultView;

                return ({
                    top: rect.top + win.pageYOffset,
                    left: rect.left + win.pageXOffset
                });
            }

            function getWindowHeight() {
                return window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight
            }

            var Item = function (el, action, options) {
                this.id = new Date().getTime();
                this.el = el;
                this.currentActiveStatus = false
                this.action = action.bind(this);
                options = options || {}
                this.options = {
                    offset: options.offset || 0,
                    scrollTop: options.scrollTop || 0,
                    rollback: options.rollback || null,
                    actionType: options.actionType || 'onece'
                };
            };

            var windowHeight = getWindowHeight(),
                that = this;

            function detectScroll(e) {

                if (e && e.type == 'resize') {
                    windowHeight = getWindowHeight();
                }

                var scrollTop = window.scrollY || document.documentElement.scrollTop;

                for (var i = that.items.length - 1; i > -1; i--) {

                    var el = that.items[i].el
                    var offsetTop = getOffset(el).top + that.items[i].options.offset;
                    var itemHeight = el.getBoundingClientRect().height;

                    if (that.items[i].options.actionType == 'custom') {

                        that.items[i].action.call(this, scrollTop);

                    } else if (that.items[i].options.actionType == 'inout') {

                        if (
                            (offsetTop > scrollTop && offsetTop < scrollTop + windowHeight) ||
                            (offsetTop + itemHeight > scrollTop && offsetTop + itemHeight < scrollTop + windowHeight) ||
                            (offsetTop < scrollTop && offsetTop + itemHeight > scrollTop + windowHeight)
                        ) {
                            if (that.items[i].currentActiveStatus !== true) {
                                that.items[i].action(el);
                                that.items[i].currentActiveStatus = true
                            }
                        } else {
                            if (that.items[i].currentActiveStatus == true) {
                                that.items[i].action(el);
                                that.items[i].currentActiveStatus = false
                            }
                        }

                    } else {

                        if (that.items[i].options.scrollTop) {
                            if (scrollTop > that.items[i].options.scrollTop) {
                                that.items[i].action(el);
                                that.items[i].currentActiveStatus = true

                                if (!that.items[i].options.rollback) {
                                    that.items.splice(i, 1)
                                }
                            } else {
                                if (that.items[i].options.rollback) {
                                    that.items[i].options.rollback(el);
                                }
                            }
                        } else {
                            if (that.items[i].options.rollback) {
                                if (scrollTop > offsetTop - windowHeight) {
                                    that.items[i].action(el);
                                    that.items[i].currentActiveStatus = true
                                } else {
                                    if (that.items[i].options.rollback) {
                                        that.items[i].currentActiveStatus = false
                                        that.items[i].options.rollback(el);
                                    }
                                }

                            } else {
                                if (
                                    (offsetTop > scrollTop && offsetTop < scrollTop + windowHeight) ||
                                    (offsetTop + itemHeight > scrollTop && offsetTop + itemHeight < scrollTop + windowHeight) ||
                                    (offsetTop < scrollTop && offsetTop + itemHeight > scrollTop + windowHeight)
                                ) {
                                    that.items[i].action(el);
                                    that.items[i].currentActiveStatus = true
                                    that.items.splice(i, 1)
                                }
                            }
                        }
                    }
                }
            }
            window.addEventListener('scroll', detectScroll);
            window.addEventListener('resize', detectScroll);
        };

        // detector.js
        var sd = new ScrollDetector();
        var scrollParallaxTriggerTop = $('#stickyStart').offset().top
        var scrollParallaxTriggerEndTop = $('#stickyEnd').offset().top + 200
        var scrollParallaxStart = scrollParallaxTriggerTop - window.innerHeight
        var maxRatio = scrollParallaxTriggerEndTop - scrollParallaxStart;

        sd.add(document.getElementById('stickyStart'), function () {
            $(".scrolling-contents").addClass("on")
        }, { actionType: "in" })
    </script>
</body>

</html>